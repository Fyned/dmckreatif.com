Options -Indexes
DirectoryIndex index.html

# Security headers
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set Permissions-Policy "camera=(), microphone=(), geolocation=()"
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

RewriteEngine On

# www → non-www redirect (301 permanent)
RewriteCond %{HTTP_HOST} ^www\.dmckreatif\.com [NC]
RewriteRule ^(.*)$ https://dmckreatif.com/$1 [R=301,L]

# Old WordPress URL redirects (301 permanent)
RewriteRule ^services-2/?$ /en/services [R=301,L]
RewriteRule ^contact-2/?$ /en/contact [R=301,L]
RewriteRule ^home/?$ /en [R=301,L]
RewriteRule ^portfolio-items/(.*)$ /en/portfolio [R=301,L]
RewriteRule ^portfolio_category/(.*)$ /en/portfolio [R=301,L]
RewriteRule ^category/(.*)$ /en/blog [R=301,L]
RewriteRule ^the-magazine/?$ /en/blog [R=301,L]
RewriteRule ^projects/(.*)$ /en/portfolio [R=301,L]
RewriteRule ^de/login/?$ /de [R=301,L]
RewriteRule ^services/?$ /en/services [R=301,L]
RewriteRule ^about/?$ /en/about [R=301,L]
RewriteRule ^pricing/?$ /en/pricing [R=301,L]

# Turkish locale redirect (TR not supported — only en/fr/nl/de)
RewriteRule ^tr/?$ /en [R=301,L]
RewriteRule ^tr/(.+)$ /en/$1 [R=301,L]

# Non-locale blog URLs → English blog (old WP or direct links)
RewriteRule ^blog/(.+)$ /en/blog/$1 [R=301,L]
RewriteRule ^blog/?$ /en/blog [R=301,L]

# Redirect root to /en
RewriteRule ^$ /en [R=301,L]

# React SPA fallback
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ /index.html [L]

# Cache: immutable hashed assets
<FilesMatch "\.(js|css|woff2|woff|ttf)$">
  Header set Cache-Control "public, max-age=31536000, immutable"
</FilesMatch>

# Cache: HTML - always fresh
<FilesMatch "\.(html)$">
  Header set Cache-Control "no-cache, no-store, must-revalidate"
</FilesMatch>

# Cache: images - 1 month
<FilesMatch "\.(png|jpg|jpeg|gif|webp|avif|svg|ico)$">
  Header set Cache-Control "public, max-age=2592000"
</FilesMatch>

# Gzip compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/javascript application/json image/svg+xml application/xml text/xml
</IfModule>

# Content-Security-Policy (report-only for now)
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://*.supabase.co https://*.google-analytics.com https://*.googletagmanager.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https: blob:; font-src 'self'; connect-src 'self' https://*.supabase.co https://*.google-analytics.com https://*.analytics.google.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'"

