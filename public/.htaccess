Options -Indexes

# Security headers
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set Permissions-Policy "camera=(), microphone=(), geolocation=()"
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

# Redirect root to /en
RewriteEngine On
RewriteRule ^$ /en [R=301,L]

# React SPA fallback
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ /index.html [L]

# Cache: immutable hashed assets
<FilesMatch "\.(js|css|woff2|woff|ttf)$">
  Header set Cache-Control "public, max-age=31536000, immutable"
</FilesMatch>

# Cache: HTML - always fresh
<FilesMatch "\.(html)$">
  Header set Cache-Control "no-cache, no-store, must-revalidate"
</FilesMatch>

# Cache: images - 1 month
<FilesMatch "\.(png|jpg|jpeg|gif|webp|avif|svg|ico)$">
  Header set Cache-Control "public, max-age=2592000"
</FilesMatch>

# Gzip compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/javascript application/json image/svg+xml
</IfModule>
